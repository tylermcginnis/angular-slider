window.AngularSlider=function(e,t,n){function w(e){a.cssText=e}function E(e,t){return w(prefixes.join(e+";")+(t||""))}function S(e,t){return typeof e===t}function x(e,t){return!!~(""+e).indexOf(t)}function T(e,t,r){for(var i in e){var s=t[e[i]];if(s!==n){if(r===false)return e[i];if(S(s,"function")){return s.bind(r||t)}return s}}return false}function N(){i["inputtypes"]=function(e){for(var r=0,i,o,u,a=e.length;r<a;r++){f.setAttribute("type",o=e[r]);i=f.type!=="text";if(i){f.value=l;f.style.cssText="position:absolute;visibility:hidden;";if(/^range$/.test(o)&&f.style.WebkitAppearance!==n){s.appendChild(f);u=t.defaultView;i=u.getComputedStyle&&u.getComputedStyle(f,null).WebkitAppearance!=="textfield"&&f.offsetHeight!==0;s.removeChild(f)}else if(/^(search|tel)$/.test(o)){}else if(/^(url|email)$/.test(o)){i=f.checkValidity&&f.checkValidity()===false}else{i=f.value!=l}}p[e[r]]=!!i}return p}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var r="2.7.1",i={},s=t.documentElement,o="modernizr",u=t.createElement(o),a=u.style,f=t.createElement("input"),l=":)",c={}.toString,h={},p={},d={},v=[],m=v.slice,g,y={}.hasOwnProperty,b;if(!S(y,"undefined")&&!S(y.call,"undefined")){b=function(e,t){return y.call(e,t)}}else{b=function(e,t){return t in e&&S(e.constructor.prototype[t],"undefined")}}if(!Function.prototype.bind){Function.prototype.bind=function(t){var n=this;if(typeof n!="function"){throw new TypeError}var r=m.call(arguments,1),i=function(){if(this instanceof i){var e=function(){};e.prototype=n.prototype;var s=new e;var o=n.apply(s,r.concat(m.call(arguments)));if(Object(o)===o){return o}return s}else{return n.apply(t,r.concat(m.call(arguments)))}};return i}}for(var C in h){if(b(h,C)){g=C.toLowerCase();i[g]=h[C]();v.push((i[g]?"":"no-")+g)}}i.input||N();i.addTest=function(e,t){if(typeof e=="object"){for(var r in e){if(b(e,r)){i.addTest(r,e[r])}}}else{e=e.toLowerCase();if(i[e]!==n){return i}t=typeof t=="function"?t():t;if(typeof enableClasses!=="undefined"&&enableClasses){s.className+=" "+(t?"":"no-")+e}i[e]=t}return i};w("");u=f=null;i._version=r;return i}(this,this.document);(function(e,t,n){function r(e){return"[object Function]"==d.call(e)}function i(e){return"string"==typeof e}function s(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function u(){var e=v.shift();m=1,e?e.t?h(function(){("c"==e.t?k.injectCss:k.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),u()):m=0}function a(e,n,r,i,s,a,f){function l(t){if(!d&&o(c.readyState)&&(w.r=d=1,!m&&u(),c.onload=c.onreadystatechange=null,t)){"img"!=e&&h(function(){b.removeChild(c)},50);for(var r in T[n])T[n].hasOwnProperty(r)&&T[n][r].onload()}}var f=f||k.errorTimeout,c=t.createElement(e),d=0,g=0,w={t:r,s:n,e:s,a:a,x:f};1===T[n]&&(g=1,T[n]=[]),"object"==e?c.data=n:(c.src=n,c.type=e),c.width=c.height="0",c.onerror=c.onload=c.onreadystatechange=function(){l.call(this,g)},v.splice(i,0,w),"img"!=e&&(g||2===T[n]?(b.insertBefore(c,y?null:p),h(l,f)):T[n].push(c))}function f(e,t,n,r,s){return m=0,t=t||"j",i(e)?a("c"==t?E:w,e,t,this.i++,n,r,s):(v.splice(this.i++,0,e),1==v.length&&u()),this}function l(){var e=k;return e.loader={load:f,i:0},e}var c=t.documentElement,h=e.setTimeout,p=t.getElementsByTagName("script")[0],d={}.toString,v=[],m=0,g="MozAppearance"in c.style,y=g&&!!t.createRange().compareNode,b=y?c:p.parentNode,c=e.opera&&"[object Opera]"==d.call(e.opera),c=!!t.attachEvent&&!c,w=g?"object":c?"script":"img",E=c?"script":w,S=Array.isArray||function(e){return"[object Array]"==d.call(e)},x=[],T={},N={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}},C,k;k=function(e){function t(e){var e=e.split("!"),t=x.length,n=e.pop(),r=e.length,n={url:n,origUrl:n,prefixes:e},i,s,o;for(s=0;s<r;s++)o=e[s].split("="),(i=N[o.shift()])&&(n=i(n,o));for(s=0;s<t;s++)n=x[s](n);return n}function o(e,i,s,o,u){var a=t(e),f=a.autoCallback;a.url.split(".").pop().split("?").shift(),a.bypass||(i&&(i=r(i)?i:i[e]||i[o]||i[e.split("/").pop().split("?")[0]]),a.instead?a.instead(e,i,s,o,u):(T[a.url]?a.noexec=!0:T[a.url]=1,s.load(a.url,a.forceCSS||!a.forceJS&&"css"==a.url.split(".").pop().split("?").shift()?"c":n,a.noexec,a.attrs,a.timeout),(r(i)||r(f))&&s.load(function(){l(),i&&i(a.origUrl,u,o),f&&f(a.origUrl,u,o),T[a.url]=2})))}function u(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}),o(e,f,t,0,u);else if(Object(e)===e)for(p in h=function(){var t=0,n;for(n in e)e.hasOwnProperty(n)&&t++;return t}(),e)e.hasOwnProperty(p)&&(!n&&!--h&&(r(f)?f=function(){var e=[].slice.call(arguments);l.apply(this,e),c()}:f[p]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),c()}}(l[p])),o(e[p],f,t,p,u))}else!n&&c()}var u=!!e.test,a=e.load||e.both,f=e.callback||s,l=f,c=e.complete||s,h,p;n(u?e.yep:e.nope,!!a),a&&n(a)}var a,f,c=this.yepnope.loader;if(i(e))o(e,0,c,0);else if(S(e))for(a=0;a<e.length;a++)f=e[a],i(f)?o(f,0,c,0):S(f)?k(f):Object(f)===f&&u(f,c);else Object(e)===e&&u(e,c)},k.addPrefix=function(e,t){N[e]=t},k.addFilter=function(e){x.push(e)},k.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",C=function(){t.removeEventListener("DOMContentLoaded",C,0),t.readyState="complete"},0)),e.yepnope=l(),e.yepnope.executeStack=u,e.yepnope.injectJs=function(e,n,r,i,a,f){var l=t.createElement("script"),c,d,i=i||k.errorTimeout;l.src=e;for(d in r)l.setAttribute(d,r[d]);n=f?u:n||s,l.onreadystatechange=l.onload=function(){!c&&o(l.readyState)&&(c=1,n(),l.onload=l.onreadystatechange=null)},h(function(){c||(c=1,n(1))},i),a?l.onload():p.parentNode.insertBefore(l,p)},e.yepnope.injectCss=function(e,n,r,i,o,a){var i=t.createElement("link"),f,n=a?u:n||s;i.href=e,i.rel="stylesheet",i.type="text/css";for(f in r)i.setAttribute(f,r[f]);o||(p.parentNode.insertBefore(i,p),h(n,0))}})(this,document);AngularSlider.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};angular.module("vr.directives.slider",["ngTouch"]).directive("slider",["$timeout","$document","$interpolate","$swipe",function(e,t,n,r){function u(e){return angular.element(e)}function a(e){return""+e+"px"}function f(e,t){return e.css({opacity:t})}function l(e){return f(e,0)}function c(e){return f(e,1)}function h(e,t){return e.css({left:t})}function p(e){var t=parseFloat(e.css("width"));return isNaN(t)?e[0].offsetWidth:t}function d(e){return p(e)/2}function v(e){try{return e.offset().left}catch(t){}return e[0].getBoundingClientRect().left}function m(e,t){if(v(e)>v(t)){return v(e)-v(t)-p(t)}return v(t)-v(e)-p(e)}function g(e,t){return e.attr("ng-bind-template",t)}function y(e,t,n,r,i,s){if(isNaN(e)){if(arguments.length===6){e=s}value2=0}else{value2=e}if(angular.isUndefined(t)||!t){t=0}if(angular.isUndefined(n)||!n||n==0){n=1/Math.pow(10,t)}if(angular.isUndefined(r)||!r){r=0}var o=(value2-r)%n;var u=o>n/2?value2+n-o:value2-o;if(angular.isUndefined(i)||!i){i=u}u=Math.min(Math.max(u,r),i);if(isNaN(e)){return e}else{return parseFloat(u.toFixed(t))}}function b(e,t){if(e>0&&!isNaN(t)){return Math.ceil(t/e)*e}return t}function w(e){return s+" "+e+" "+o}var i=3;var s=n.startSymbol(),o=n.endSymbol();return{restrict:"EA",scope:{floor:"@",ceiling:"@",step:"@",precision:"@",buffer:"@",stickiness:"@",showSteps:"@",ngModel:"=",ngModelLow:"=",ngModelHigh:"=",translate:"&",translateRange:"&",translateCombined:"&",scale:"&",inverseScale:"&"},template:"<span class='bar full'></span>"+"<span class='bar steps'><span class='bubble step' ng-repeat='step in stepBubbles()'></span></span>"+"<span class='bar selection'></span><span class='bar unselected low'></span><span class='bar unselected high'></span>"+"<span class='pointer low' id='thePointer'></span><span class='pointer high'></span>"+"<span class='bubble low'></span><span class='bubble high'></span><span class='bubble middle'></span><span class='bubble selection'></span>"+"<span class='bubble limit floor'></span><span class='bubble limit ceiling'></span>"+"<input type='range' class='input low' /><input type='range' class='input high' /><input type='range' class='input selection' />",compile:function(n,s){function C(e){if(!e){e=n}var t=[];angular.forEach(e.children(),function(e){t.push(u(e))});return t}function k(e,t,n){return{fullBar:e[0],stepBubs:e[1],selBar:t?e[2]:null,unSelBarLow:t?e[3]:null,unSelBarHigh:t?e[4]:null,minPtr:t?e[5]:e[2],maxPtr:t?e[6]:null,lowBub:t?e[7]:e[3],highBub:t?e[8]:null,cmbBub:t?e[9]:null,selBub:t?e[10]:null,flrBub:t?e[11]:e[4],ceilBub:t?e[12]:e[5],minInput:n?t?e[13]:e[6]:null,maxInput:n?t?e[14]:null:null,selInput:n?t?e[15]:null:null}}var o=s.showSteps;var f=s.ngModel==null&&s.ngModelLow!=null&&s.ngModelHigh!=null,E={},S=f?"ngModelLow":"ngModel",x="ngModelHigh",T="selectBar",N=["floor","ceiling","stickiness",S];E=function(){var e=C();var t=[];for(var n=0,r=e.length;n<r;n++){var i=e[n];i=u(i);i.css({"white-space":"nowrap",position:"absolute",display:"block","z-index":1});t.push(i)}return t}();E=k(E,true,true);if(s.translate){s.$set("translate",""+s.translate+"(value)")}if(s.translateRange){s.$set("translateRange",""+s.translateRange+"(low,high)")}if(s.translateCombined){s.$set("translateCombined",""+s.translateCombined+"(low,high)")}if(s.scale){s.$set("scale",""+s.scale+"(value)")}if(s.inverseScale){s.$set("inverseScale",""+s.inverseScale+"(value)")}E.fullBar.css({left:0,right:0});if(AngularSlider.inputtypes.range){var L={position:"absolute",margin:0,padding:0,opacity:0,height:"100%"};E.minInput.attr("step",w("inputSteps()"));E.minInput.attr("min",w("floor"));E.minInput.css(L);E.minInput.css("left",0);if(f){E.minInput.attr("max",w("ngModelHigh - (buffer / 2)"));E.maxInput.attr("step",w("inputSteps()"));E.maxInput.attr("min",w("ngModelLow + (buffer / 2)"));E.maxInput.attr("max",w("ceiling"));E.maxInput.css(L);E.selInput.attr("step",w("inputSteps()"));E.selInput.attr("min",w("ngModelLow"));E.selInput.attr("max",w("ngModelHigh"));E.selInput.css(L)}else{E.minInput.attr("max",w("ceiling"));E.minInput.css({width:"100%"});E.maxInput.remove();E.selInput.remove()}}else{E.minInput.remove();E.maxInput.remove();E.selInput.remove()}g(E.stepBubs.children().eq(0),w("translation(step)"));g(E.ceilBub,w("translation(ceiling)"));g(E.flrBub,w("translation(floor)"));g(E.selBub,w("rangeTranslation("+S+","+x+")"));g(E.lowBub,w("translation("+S+")"));g(E.highBub,w("translation("+x+")"));g(E.cmbBub,w("combinedTranslation("+S+","+x+")"));if(f){N.push(x);N.unshift("buffer")}else{var A=[E.selBar,E.unSelBarLow,E.unSelBarHigh,E.maxPtr,E.selBub,E.highBub,E.cmbBub];for(var O=0,M=A.length;O<M;O++){n=A[O];n.remove()}}N.unshift("precision","step");if(!o){E.stepBubs.children().remove()}return{post:function(n,s,o){function q(){angular.forEach(N,function(e){if(n[e]!==n.ngModel){n[e]=parseFloat(n[e])}if(e==S||e==x){n[e]=y(n[e],n.precision,n.step,n.floor,n.ceiling,n.ngModel)}else if(e=="buffer"){if(!n.buffer||isNaN(n.buffer)||n.buffer<0){n.buffer=0}else{n.buffer=b(n.step,n.buffer)}}else if(e=="precision"){if(!n.precision||isNaN(n.precision)){n.precision=0}else{n.precision=parseInt(n.precision)}}else if(e=="step"){if(!n.step||isNaN(n.step)){n.step=1/Math.pow(10,n.precision)}else{n.step=parseFloat(n.step.toFixed(n.precision))}}else if(e=="stickiness"){if(isNaN(n.stickiness)){n.stickiness=i}else if(n.stickiness<1){n.stickiness=1}}n.decodedValues[e]=n.decodeRef(e)});w=p(g.fullBar);E=d(g.minPtr);L=v(g.fullBar);A=L+w-p(g.minPtr);O=A-L;M=n.floor;_=n.decodedValues.floor;D=n.ceiling;P=n.decodedValues.ceiling;H=D-M;B=P-_}function R(){function C(e){return(e-L)/O*100}function k(e){return C(e)/100*B+_}function P(e){return n.encode(k(e))}function H(e){return(e-_)/B*O+L}function R(e){return H(n.decode(e))}function U(e){return(e-_)/B*100}function z(e){return U(n.decode(e))}function W(e){return a(e*O/100)}function X(e){return Math.min(Math.max(e,L),A)}function V(e){return h(e,W(C(X(v(e)))))}function $(e,t,r){var i=e>0?1:-1;t=!t?100:t;if(r){return(Math.sin(Math.min(Math.abs(e/t),1)*Math.PI-Math.PI/2)+1)*i*t/6}return i*Math.pow(Math.min(Math.abs(e/t*2),1),n.stickiness)*t/2}function J(){var e=U(n.decodedValues[S]);var t=z(n[S]+n.step)-e;var r=e-z(n[S]-n.step);var i=z(n[S]+n.buffer)-e;var s=C(E+L);var o=e+$(j,j>0?t:r);h(g.minPtr,W(o));h(g.lowBub,W(C(v(g.minPtr)-d(g.lowBub)+E)));if(f){var u=U(n.decodedValues[x]);var a=z(n[x]+n.step)-u;var l=u-z(n[x]-n.step);var c=u-z(n[x]-n.buffer);var p=u+$(F,F>0?a:l);if(o>u-c){o=e+$(j,i,true);h(g.minPtr,W(o));h(g.lowBub,W(C(v(g.minPtr)-d(g.lowBub)+E)))}if(p<e+i){p=u+$(F,c,true)}h(g.maxPtr,W(p));h(g.highBub,W(C(v(g.maxPtr)-d(g.highBub)+E)));h(g.selBar,W(o+s));g.selBar.css({width:W(p-o)});h(g.selBub,W((o+p)/2-C(d(g.selBub)+L)+s));h(g.cmbBub,W((o+p)/2-C(d(g.cmbBub)+L)+s));g.unSelBarLow.css({left:0,width:W(o+s)});h(g.unSelBarHigh,W(p+s));g.unSelBarHigh.css({right:0});if(AngularSlider.inputtypes.range){var m=s*2;var y=o+i/2;var b=p-c/2;g.minInput.css({width:W(b)});g.maxInput.css({left:W(y+m),width:W(100-y)});g.selInput.css({left:W(o+m),width:W(p-o-m)})}}}function K(){var e=g.lowBub;V(g.lowBub);if(f){V(g.highBub);V(g.selBub);if(m(g.lowBub,g.highBub)<10){l(g.lowBub);l(g.highBub);c(g.cmbBub);V(g.cmbBub);e=g.cmbBub}else{c(g.lowBub);c(g.highBub);l(g.cmbBub);e=g.highBub}}if(m(g.flrBub,g.lowBub)<5){l(g.flrBub)}else{if(f){if(m(g.flrBub,e)<5){l(g.flrBub)}else{c(g.flrBub)}}else{c(g.flrBub)}}if(m(g.lowBub,g.ceilBub)<5){l(g.ceilBub)}else{if(f){if(m(e,g.ceilBub)<5){l(g.ceilBub)}else{c(g.ceilBub)}}else{c(g.ceilBub)}}}function Q(){j=0;F=0;if(b){J();K();b.removeClass("active")}b=null;N=null;e=false}function G(t){if(b){n.$apply(function(){var r=t.clientX||t.x;if(e){var u=P(r)-i;var a=P(r)+o;if(u<M){a+=M-u;u=M}else if(a>D){u-=a-D;a=D}var l=z(u);var c=z(a);j=l;F=c;n[S]=u=y(u,n.precision,n.step,n.floor,n.ceiling);n[x]=a=y(a,n.precision,n.step,n.floor,n.ceiling);j=j-z(u);F=F-z(a)}else{var h=X(r+L-v(s)-d(b));var p=C(h);var m=n.encode(_+B*p/100);j=p;if(f){if(n.buffer>0){if(N===S){if(m>n[x]-n.buffer){m=n[x]-n.buffer}}else{if(m<n[S]+n.buffer){m=n[S]+n.buffer}}}else{if(N===S){if(m>n[x]){n[S]=n[x];n.decodedValues[S]=n.decodeRef(S);N=x;var w=g.minPtr;g.minPtr=g.maxPtr;g.maxPtr=w;g.maxPtr.removeClass("active").removeClass("high").addClass("low");g.minPtr.addClass("active").removeClass("low").addClass("high")}}else{if(m<n[S]){n[x]=n[S];n.decodedValues[x]=n.decodeRef(x);N=S;var w=g.minPtr;g.minPtr=g.maxPtr;g.maxPtr=w;g.minPtr.removeClass("active").removeClass("low").addClass("high");g.maxPtr.addClass("active").removeClass("high").addClass("low")}}}}n[N]=m=y(m,n.precision,n.step,n.floor,n.ceiling);n.decodedValues[N]=n.decodeRef(N);if(N===S){j=j-z(m);F=0}else{F=j-z(m);j=0}}J();K()})}}function Y(t,r,u){b=r;N=u;b.addClass("active");var a=t.clientX||t.x;var f=_+B*C(X(a+L-v(s)))/100;if(N==T){e=true;var l=P(a);i=l-n[S];o=n[x]-l}console.log("VAL ABOUT TO BE PASSED IN TO ROUNDSTEP IS scope.encode(newValue)",n.encode(f));n[N]=y(n.encode(f),n.precision,n.step,n.floor,n.ceiling);J();K();n.$apply();q()}function Z(){if(AngularSlider.inputtypes.range){function e(e,t,n){function i(e){Y(e,t,n)}function s(e){G(e);Q()}e=u(e);if(window.navigator.pointerEnabled){e.on("pointerdown",i).on("pointermove",G).on("pointerup",s).on("pointercancel",Q)}else if(window.navigator.msPointerEnabled){e.on("MSPointerDown",i).on("MSPointerMove",G).on("MSPointerUp",s).on("MSPointerCancel",Q)}else{r.bind(e,{start:i,move:G,end:s,cancel:Q})}}e(g.minInput,g.minPtr,S);if(f){e(g.maxInput,g.maxPtr,x);e(g.selInput,g.selBar,T)}}else{function n(e,t,n){e=u(e);if(angular.isUndefined(n)){n=e}else{n=u(n)}r.bind(e,{start:function(e){Y(e,n,t)}})}function i(e){e=u(e);r.bind(e,{move:G,end:function(e){G(e);Q()},cancel:Q})}i(t);n(g.minPtr,S);n(g.lowBub,S);n(g.flrBub,S,g.minPtr);if(f){n(g.maxPtr,x);n(g.highBub,x);n(g.ceilBub,x,g.maxPtr);n(g.selBar,T);n(g.selBub,T,g.selBar);n(g.unSelBarLow,S,g.minPtr);n(g.unSelBarHigh,x,g.maxPtr)}else{n(g.ceilBub,S,g.minPtr);n(g.fullBar,S,g.minPtr)}}}var e,i,o,b,N;q();h(g.flrBub,0);h(g.ceilBub,a(w-p(g.ceilBub)));J();K();if(!I){Z();I=true}}var g=k(C(s),f,AngularSlider.inputtypes.range);n.decodedValues={floor:0,ceiling:0,step:0,precision:0,buffer:0,stickiness:0,ngModel:0,ngModelLow:0,ngModelHigh:0};n.translation=function(e){e=parseFloat(e).toFixed(n.precision);if(angular.isUndefined(o.translate)){return""+e}return n.translate({value:e})};n.rangeTranslation=function(e,t){if(angular.isUndefined(o.translateRange)){return"Range: "+n.translation(t-e)}return n.translateRange({low:e,high:t})};n.combinedTranslation=function(e,t){if(angular.isUndefined(o.translateCombined)){return n.translation(e)+" - "+n.translation(t)}return n.translateCombined({low:e,high:t})};n.encode=function(e){if(angular.isUndefined(o.scale)||o.scale==""){return e}return n.scale({value:e})};n.decode=function(e){if(angular.isUndefined(o.inverseScale)||o.inverseScale==""){return e}return n.inverseScale({value:e})};if(Math.round(n.encode(n.decode(1)))!=1||Math.round(n.encode(n.decode(100)))!=100){console.warn("The scale and inverseScale functions are not perfect inverses: 1 = "+n.encode(n.decode(1))+"  100 = "+n.encode(n.decode(100)))}n.decodeRef=function(e){return n.decode(n[e])};n.inputSteps=function(){return Math.pow(10,n.precision*-1)};var w=0;var E=0;var L=0;var A=0;var O=0;var M=0;var _=0;var D=0;var P=0;var H=0;var B=0;var j=0;var F=0;var I=false;for(var U=0;U<N.length;U++){n.$watch(N[U],function(){R()})}u(window).bind("resize",function(){R()});n.$on("refreshSlider",function(){e(function(){R()})});e(function(){R()})}}}}}])